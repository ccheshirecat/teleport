import{r as a,v as p,w as h,x as g,n as e,F as l}from"./components-qZBQBQPF.js";import{L as m,F as y,c,d as f}from"./Layout-Dy0sIyeH.js";import{F as b}from"./ArrowPathIcon-ZyBmY1DV.js";function j({title:s,titleId:t,...r},n){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),s?a.createElement("title",{id:t},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const x=a.forwardRef(j);function N({title:s,titleId:t,...r},n){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),s?a.createElement("title",{id:t},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const w=a.forwardRef(N),F=()=>[{title:"Slaves - Teleport"},{name:"description",content:"Manage Caddy slave instances"}];function L(){const{slaves:s,error:t}=p(),r=h(),n=g(),[u,i]=a.useState(!1),d=n.state==="submitting";return t?e.jsx(m,{children:e.jsx("div",{className:"p-8",children:e.jsx("div",{className:"rounded-lg bg-error-50 border border-error-200 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(y,{className:"h-5 w-5 text-error-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-error-800",children:"Failed to load slaves"}),e.jsx("p",{className:"mt-1 text-sm text-error-700",children:t})]})]})})})}):e.jsx(m,{children:e.jsxs("div",{className:"p-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Slave Management"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Manage your Caddy slave instances"})]}),e.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-200",children:[e.jsx(x,{className:"h-4 w-4 mr-2"}),"Add Slave"]})]})}),r&&e.jsx("div",{className:c("mb-6 rounded-lg border p-4",r.success?"bg-success-50 border-success-200 text-success-800":"bg-error-50 border-error-200 text-error-800"),children:r.message}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Add New Slave"}),e.jsxs(l,{method:"post",onSubmit:()=>i(!1),children:[e.jsx("input",{type:"hidden",name:"intent",value:"create"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",name:"name",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"e.g., edge-sgp-01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"WireGuard IP"}),e.jsx("input",{type:"text",name:"wireguard_ip",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"e.g., 10.0.1.10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Caddy Admin Port"}),e.jsx("input",{type:"number",name:"caddy_admin_port",defaultValue:2019,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"API Scheme"}),e.jsxs("select",{name:"caddy_admin_api_scheme",defaultValue:"http",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"http",children:"HTTP"}),e.jsx("option",{value:"https",children:"HTTPS"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"is_enabled",value:"true",defaultChecked:!0,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{className:"ml-2 block text-sm text-gray-700",children:"Enable slave"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors duration-200",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:d,className:"px-4 py-2 text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 rounded-lg transition-colors duration-200 disabled:opacity-50",children:d?"Creating...":"Create Slave"})]})]})]})}),e.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-xl border border-gray-200/50 shadow-glass overflow-hidden",children:s.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Slave"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Connection"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Sync"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white/50 divide-y divide-gray-200",children:s.map(o=>e.jsx(v,{slave:o,isSubmitting:d},o.id))})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(f,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No slaves"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by adding your first Caddy slave instance."}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-lg text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(x,{className:"h-4 w-4 mr-2"}),"Add Slave"]})})]})})]})})}function v({slave:s,isSubmitting:t}){return e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:c("flex-shrink-0 h-3 w-3 rounded-full",s.is_enabled?"bg-success-400":"bg-gray-400")}),e.jsxs("div",{className:"ml-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.id.slice(0,8),"..."]})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-gray-900",children:[s.wireguard_ip,":",s.caddy_admin_port]}),e.jsx("div",{className:"text-sm text-gray-500",children:s.caddy_admin_api_scheme.toUpperCase()})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:c("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",k(s.last_sync_status)),children:s.last_sync_status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.last_sync_timestamp?new Date(s.last_sync_timestamp).toLocaleString():"Never"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2",children:[e.jsxs(l,{method:"post",className:"inline",children:[e.jsx("input",{type:"hidden",name:"intent",value:"sync"}),e.jsx("input",{type:"hidden",name:"id",value:s.id}),e.jsx("button",{type:"submit",disabled:t||!s.is_enabled,className:"text-primary-600 hover:text-primary-900 disabled:opacity-50 disabled:cursor-not-allowed",title:"Sync configuration",children:e.jsx(b,{className:"h-4 w-4"})})]}),e.jsxs(l,{method:"post",className:"inline",onSubmit:r=>{confirm("Are you sure you want to delete this slave?")||r.preventDefault()},children:[e.jsx("input",{type:"hidden",name:"intent",value:"delete"}),e.jsx("input",{type:"hidden",name:"id",value:s.id}),e.jsx("button",{type:"submit",disabled:t,className:"text-error-600 hover:text-error-900 disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete slave",children:e.jsx(w,{className:"h-4 w-4"})})]})]})]})}function k(s){switch(s){case"success":return"text-success-700 bg-success-100";case"error":return"text-error-700 bg-error-100";case"pending":return"text-warning-700 bg-warning-100";case"syncing":return"text-primary-700 bg-primary-100";default:return"text-gray-700 bg-gray-100"}}export{L as default,F as meta};
