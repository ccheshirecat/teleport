import{v as N,r as x,n as e}from"./components-qZBQBQPF.js";import{L as m,F as h,c as r,d as o,b,e as v}from"./Layout-Dy0sIyeH.js";import{F as w}from"./ArrowPathIcon-ZyBmY1DV.js";import{F as g}from"./CheckCircleIcon-B6_8jjhy.js";const C=()=>[{title:"Status - Teleport"},{name:"description",content:"System status and health monitoring"}];function D(){const{status:s,slaves:a,error:i}=N(),[c,d]=x.useState(new Date),[n,p]=x.useState(!1),u=async()=>{p(!0),window.location.reload()};if(x.useEffect(()=>{const t=setInterval(()=>{d(new Date)},3e4);return()=>clearInterval(t)},[]),i)return e.jsx(m,{children:e.jsx("div",{className:"p-8",children:e.jsx("div",{className:"rounded-lg bg-error-50 border border-error-200 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(h,{className:"h-5 w-5 text-error-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-error-800",children:"Failed to load status data"}),e.jsx("p",{className:"mt-1 text-sm text-error-700",children:i})]})]})})})});const y=a.filter(t=>t.is_enabled&&t.last_sync_status==="success"),f=a.filter(t=>t.is_enabled&&t.last_sync_status==="error"),j=a.filter(t=>t.is_enabled&&["pending","syncing"].includes(t.last_sync_status));return e.jsx(m,{children:e.jsxs("div",{className:"p-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"System Status"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Monitor the health and status of your Caddy fleet"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Last updated: ",c.toLocaleTimeString()]}),e.jsxs("button",{onClick:u,disabled:n,className:r("inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm","text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500","transition-colors duration-200",n&&"opacity-50 cursor-not-allowed"),children:[e.jsx(w,{className:r("h-4 w-4 mr-2",n&&"animate-spin")}),n?"Refreshing...":"Refresh"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(l,{title:"Total Slaves",value:(s==null?void 0:s.total_slaves)||0,icon:o,color:"primary"}),e.jsx(l,{title:"Healthy",value:y.length,icon:g,color:"success"}),e.jsx(l,{title:"Unhealthy",value:f.length,icon:h,color:"error"}),e.jsx(l,{title:"Pending",value:j.length,icon:b,color:"warning"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-xl border border-gray-200/50 shadow-glass p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center mb-4",children:[e.jsx(v,{className:"h-5 w-5 mr-2 text-primary-600"}),"Fleet Health"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Enabled Slaves"}),e.jsx("span",{className:"text-sm font-bold text-gray-900",children:(s==null?void 0:s.enabled_slaves)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"In Sync"}),e.jsx("span",{className:"text-sm font-bold text-success-600",children:(s==null?void 0:s.slaves_in_sync)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"With Errors"}),e.jsx("span",{className:"text-sm font-bold text-error-600",children:(s==null?void 0:s.slaves_with_errors)||0})]}),(s==null?void 0:s.enabled_slaves)&&s.enabled_slaves>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Health Score"}),e.jsxs("span",{className:"font-medium",children:[Math.round((s.slaves_in_sync||0)/s.enabled_slaves*100),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-success-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.round((s.slaves_in_sync||0)/s.enabled_slaves*100)}%`}})})]})]})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-xl border border-gray-200/50 shadow-glass p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center mb-4",children:[e.jsx(g,{className:"h-5 w-5 mr-2 text-primary-600"}),"Active Configuration"]}),s!=null&&s.active_configuration?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Version ID:"}),e.jsx("p",{className:"text-sm text-gray-900 font-mono",children:s.active_configuration.version_id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Description:"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.active_configuration.description})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Created:"}),e.jsx("p",{className:"text-sm text-gray-900",children:new Date(s.active_configuration.created_at).toLocaleString()})]})]}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No active configuration"})]})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-xl border border-gray-200/50 shadow-glass",children:[e.jsx("div",{className:"p-6 border-b border-gray-200/50",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(o,{className:"h-5 w-5 mr-2 text-primary-600"}),"Slave Details"]})}),a.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Slave"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Connection"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Sync"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Config Version"})]})}),e.jsx("tbody",{className:"bg-white/50 divide-y divide-gray-200",children:a.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:r("flex-shrink-0 h-3 w-3 rounded-full",t.is_enabled?"bg-success-400":"bg-gray-400")}),e.jsxs("div",{className:"ml-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[t.id.slice(0,8),"..."]})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-gray-900",children:[t.wireguard_ip,":",t.caddy_admin_port]}),e.jsx("div",{className:"text-sm text-gray-500",children:t.caddy_admin_api_scheme.toUpperCase()})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:r("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",_(t.last_sync_status)),children:t.last_sync_status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.last_sync_timestamp?new Date(t.last_sync_timestamp).toLocaleString():"Never"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-mono",children:t.last_known_config_version_id||"None"})]},t.id))})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(o,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No slaves configured"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Add slaves to monitor their status here."})]})]})]})})}function l({title:s,value:a,icon:i,color:c}){const d={primary:"text-primary-600 bg-primary-50",success:"text-success-600 bg-success-50",error:"text-error-600 bg-error-50",warning:"text-warning-600 bg-warning-50"};return e.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-xl border border-gray-200/50 shadow-glass p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:r("p-2 rounded-lg",d[c]),children:e.jsx(i,{className:"h-6 w-6"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a})]})]})})}function _(s){switch(s){case"success":return"text-success-700 bg-success-100";case"error":return"text-error-700 bg-error-100";case"pending":return"text-warning-700 bg-warning-100";case"syncing":return"text-primary-700 bg-primary-100";default:return"text-gray-700 bg-gray-100"}}export{D as default,C as meta};
